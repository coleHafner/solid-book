<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Debugging Node | The Big Incomplete Book of Dev</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../../../detail/php/xdebug/index.html" />
    
    
    <link rel="prev" href="../../../general/workflow/index.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="../../../gitbook/style.css">
    
    

        
    <div class="book" data-level="2.2" data-basepath="../../.." data-revision="Tue Jun 16 2015 13:25:10 GMT-0700 (PDT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="general/architecture/project-setup/index.html">
            
                
                    <a href="../../../general/architecture/project-setup/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Setting up a project
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="general/architecture/index.html">
            
                
                    <a href="../../../general/architecture/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Architecture
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="detail/grunt/grunt-init/index.html">
            
                
                    <a href="../../../detail/grunt/grunt-init/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.1.</b>
                        
                        Scaffolding
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="general/provisioning/index.html">
            
                
                    <a href="../../../general/provisioning/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Provisioning
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="detail/ansible/index.html">
            
                
                    <a href="../../../detail/ansible/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.1.</b>
                        
                        Ansible Intro
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="detail/ansible/playbooks/index.html">
            
                
                    <a href="../../../detail/ansible/playbooks/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.2.</b>
                        
                        Initial setup
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="detail/ansible/roles/index.html">
            
                
                    <a href="../../../detail/ansible/roles/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.3.</b>
                        
                        Creating roles
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> Working on a project</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="general/workflow/index.html">
            
                
                    <a href="../../../general/workflow/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Workflow
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="2.2" data-path="detail/node/debugging/index.html">
            
                
                    <a href="../../../detail/node/debugging/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Debugging Node
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="detail/php/xdebug/index.html">
            
                
                    <a href="../../../detail/php/xdebug/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Debugging PHP
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="general/devops/deployment/index.html">
            
                
                    <a href="../../../general/devops/deployment/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Deploying a project
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4" >
            
            <span><b>4.</b> General</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" >
            
            <span><b>4.1.</b> Error Handling</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="general/error-handling/exponential-backoff/index.html">
            
                
                    <a href="../../../general/error-handling/exponential-backoff/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.1.</b>
                        
                        Exponential Back Off
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="general/error-handling/javascript/index.html">
            
                
                    <a href="../../../general/error-handling/javascript/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.2.</b>
                        
                        JavaScript
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="general/file-upload/index.html">
            
                
                    <a href="../../../general/file-upload/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        File Upload
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="general/profiling/index.html">
            
                
                    <a href="../../../general/profiling/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        Profiling
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="general/version-control/index.html">
            
                
                    <a href="../../../general/version-control/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        Version Control
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.5" >
            
            <span><b>4.5.</b> Issue tracking</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="general/security/index.html">
            
                
                    <a href="../../../general/security/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.6.</b>
                        
                        Security
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" >
            
            <span><b>5.</b> Detail</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="detail/ansible/index.html">
            
                
                    <a href="../../../detail/ansible/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Ansible
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="detail/elasticsearch/index.html">
            
                
                    <a href="../../../detail/elasticsearch/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Elasticsearch
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="detail/fastcgi/index.html">
            
                
                    <a href="../../../detail/fastcgi/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        FastCgi
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="detail/form/index.html">
            
                
                    <a href="../../../detail/form/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Form
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.5" >
            
            <span><b>5.5.</b> Git</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.5.1" data-path="detail/git/gitflow/index.html">
            
                
                    <a href="../../../detail/git/gitflow/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.1.</b>
                        
                        Gitflow
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.5.2" data-path="detail/git/hooks/index.html">
            
                
                    <a href="../../../detail/git/hooks/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.2.</b>
                        
                        Hooks
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.6" >
            
            <span><b>5.6.</b> Javascript</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.6.1" data-path="detail/javascript/es6/index.html">
            
                
                    <a href="../../../detail/javascript/es6/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.1.</b>
                        
                        es6
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.7" >
            
            <span><b>5.7.</b> Mongo</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.7.1" data-path="detail/mongo/users/index.html">
            
                
                    <a href="../../../detail/mongo/users/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.1.</b>
                        
                        Users
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.8" >
            
            <span><b>5.8.</b> Mysql</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.8.1" data-path="detail/mysql/profiling/index.html">
            
                
                    <a href="../../../detail/mysql/profiling/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.1.</b>
                        
                        Profiling
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.8.2" data-path="detail/mysql/users/index.html">
            
                
                    <a href="../../../detail/mysql/users/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.2.</b>
                        
                        Users
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.9" >
            
            <span><b>5.9.</b> Nginx</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.9.1" data-path="detail/nginx/config/index.html">
            
                
                    <a href="../../../detail/nginx/config/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.1.</b>
                        
                        Config
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.9.2" data-path="detail/nginx/fastcgi-cache/index.html">
            
                
                    <a href="../../../detail/nginx/fastcgi-cache/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.2.</b>
                        
                        Fastcgi cache
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.10" >
            
            <span><b>5.10.</b> PHP</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.10.1" data-path="detail/php/xdebug/index.html">
            
                
                    <a href="../../../detail/php/xdebug/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.10.1.</b>
                        
                        Xdebug &amp; Vagrant
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.10.2" data-path="detail/php/mysql-extension/index.html">
            
                
                    <a href="../../../detail/php/mysql-extension/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.10.2.</b>
                        
                        Mysql extension
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.11" >
            
            <span><b>5.11.</b> Shell</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.11.1" data-path="detail/shell/cli/index.html">
            
                
                    <a href="../../../detail/shell/cli/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.11.1.</b>
                        
                        CLI
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.11.2" data-path="detail/shell/commands/index.html">
            
                
                    <a href="../../../detail/shell/commands/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.11.2.</b>
                        
                        Commands
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../" >The Big Incomplete Book of Dev</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="debugging-node-running-on-a-remote-server">Debugging Node running on a remote server</h1>
<p>Node uses a <a href="https://nodejs.org/api/debugger.html" target="_blank">TCP interface</a> for debugging, so if you can get a handle on the right port, you can debug apps running remotely. This means you can run through code on staging, Vagrant, etc. The following shows you how to start node with the debug flag and use an SSH tunnel to access the right port.</p>
<p>Things you need:</p>
<ul>
<li>ssh access to the server</li>
<li>ability to restart node app with <code>--debug</code> flag or <code>node-inspector</code> installed on server</li>
</ul>
<h2 id="debugging-using-webstorm">Debugging using Webstorm</h2>
<ol>
<li>Stop the app</li>
<li><p>Restart with <code>--debug</code> flag (and include any necessary env flags) (could setup a name pm2 for this)</p>
<pre><code class="lang-bash"> <span class="hljs-comment"># example with an env variable sent int</span>
 NODE_ENV=staging node --debug /home/node_user/my-app
</code></pre>
</li>
<li><p>When it starts you should see something like <code>debugger listening on 5858</code></p>
</li>
<li>Setup webstorm<ol>
<li><code>Run &gt; Debug... &gt; Edit Configurations... &gt; Add new configuration &gt; Node.js Remote Debug</code></li>
<li>Host : <code>127.0.0.1</code> - Port : <code>5858</code></li>
</ol>
</li>
<li><p>Open SSH Tunnel to gain access to servers port 5858.</p>
<pre><code class="lang-bash"> <span class="hljs-comment"># open an ssh tunnel, send it to the bg, and wait 10 seconds for connections</span>
 <span class="hljs-comment"># once all connections are closed after 10 seconds then close the tunnel</span>
 ssh <span class="hljs-operator">-f</span> -o ExitOnForwardFailure=yes -L <span class="hljs-number">5858</span>:<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">5858</span> node_user@<span class="hljs-number">168.144</span>.<span class="hljs-number">24.98</span> sleep <span class="hljs-number">10</span>
</code></pre>
</li>
<li><p>Make sure you checkout the same code on your local machine as on the remote server.</p>
</li>
<li>Run the debugger in Webstorm (drop down in upper right next to the Bug icon - or the bug icon once you&apos;ve run it once)</li>
</ol>
<h2 id="debugging-using-node-inspector-https-github-com-node-inspector-node-inspector">Debugging using <a href="https://github.com/node-inspector/node-inspector" target="_blank">Node Inspector</a></h2>
<p>You can follow similar instruction for using <a href="https://github.com/node-inspector/node-inspector" target="_blank">node-inspector</a> just use port <code>8080</code> instead of <code>5858</code> and open Chrome at: <a href="http://127.0.0.1:8080/?ws=127.0.0.1:8080&amp;port=5858" target="_blank">http://127.0.0.1:8080/?ws=127.0.0.1:8080&amp;port=5858</a> (you might want to use the <code>--debug-brk</code> flag instead of the <code>debug</code> flag if you can&apos;t set a breakpoint in time. Instead of starting with the debug flag, you woul install node incpector on the server and start the app using that.</p>
<p>In practice using Webstorm - port 5858 directly - seems to work much better.</p>
<h2 id="last-steps">Last Steps</h2>
<p>If needed don&apos;t forget to stop the app and restart without the debug flag.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../../general/workflow/index.html" class="navigation navigation-prev " aria-label="Previous page: Workflow"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../../detail/php/xdebug/index.html" class="navigation navigation-next " aria-label="Next page: Debugging PHP"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../../gitbook/app.js"></script>

    
    <script src="../../../gitbook/plugins/gitbook-plugin-jsfiddle/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"jsfiddle":{"tabs":["result","js","css","html"],"height":500,"widht":500}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
